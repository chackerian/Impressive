{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/nathanchackerian/Desktop/Impressive/screens/MessagesScreen.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect, useCallback } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport useWindowDimensions from \"react-native-web/dist/exports/useWindowDimensions\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport Background from \"./Background\";\nimport MaterialCommunityIcons from \"@expo/vector-icons/MaterialCommunityIcons\";\nimport Navbar from \"./Navbar\";\nimport TextInput from \"./TextInput\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport $ from 'jquery';\nimport firebase from 'firebase/app';\nimport { storage, store, authenticate } from \"../App.js\";\nvar convo = String(Math.floor(Math.random() * 1000000000000000));\nexport default function ChatScreen(props) {\n  var _this = this;\n\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      message = _useState2[0],\n      setMessage = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      messages = _useState4[0],\n      setMessages = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      matches = _useState6[0],\n      setMatches = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      conversation = _useState8[0],\n      setConversation = _useState8[1];\n\n  useEffect(function () {\n    store.collection('messages').doc(convo).collection('convo').orderBy('createdAt').limit(50).onSnapshot(function (snapshot) {\n      setMessages(snapshot.docs.map(function (doc) {\n        return doc.data();\n      }));\n    });\n    var matchSnap = store.collection('users').doc(props.route.params.user.email);\n    matchSnap.get().then(function (doc) {\n      setMatches(doc.data().matches);\n      console.log(matches);\n    });\n  }, []);\n\n  function sendMessage(_x) {\n    return _sendMessage.apply(this, arguments);\n  }\n\n  function _sendMessage() {\n    _sendMessage = _asyncToGenerator(_regeneratorRuntime.mark(function _callee(e) {\n      var uid, avatar;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n              uid = authenticate.currentUser.uid;\n              avatar = authenticate.currentUser.photoURL;\n\n              if (!(message.length > 0)) {\n                _context.next = 8;\n                break;\n              }\n\n              _context.next = 6;\n              return store.collection('messages').doc(convo).set({\n                createdAt: firebase.firestore.FieldValue.serverTimestamp()\n              });\n\n            case 6:\n              _context.next = 8;\n              return store.collection('messages').doc(convo).collection('convo').add({\n                text: message,\n                avatar: avatar,\n                uid: uid,\n                createdAt: firebase.firestore.FieldValue.serverTimestamp()\n              });\n\n            case 8:\n              setMessage('');\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _sendMessage.apply(this, arguments);\n  }\n\n  function changeMessage(event) {\n    console.log(\"Item\", event);\n    $(event).addClass('selected');\n    setConversation(\"name\");\n  }\n\n  var Item = function Item(_ref) {\n    var _React$createElement;\n\n    var name = _ref.name,\n        onPress = _ref.onPress,\n        backgroundColor = _ref.backgroundColor,\n        textColor = _ref.textColor;\n    return React.createElement(View, (_React$createElement = {\n      style: styles.item,\n      onClick: onPress\n    }, _defineProperty(_React$createElement, \"style\", [styles.item, backgroundColor]), _defineProperty(_React$createElement, \"s\", true), _defineProperty(_React$createElement, \"__self\", _this), _defineProperty(_React$createElement, \"__source\", {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 5\n    }), _React$createElement), React.createElement(Text, {\n      style: [styles.title, textColor],\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 7\n      }\n    }, name));\n  };\n\n  var renderItem = function renderItem(_ref2) {\n    var item = _ref2.item;\n    var backgroundColor = item.id === selectedId ? \"red\" : \"white\";\n    var color = item.id === selectedId ? 'white' : 'black';\n    return React.createElement(Item, {\n      item: item,\n      onPress: function onPress() {\n        return setSelectedId(item.id);\n      },\n      backgroundColor: {\n        backgroundColor: backgroundColor\n      },\n      textColor: {\n        color: color\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 7\n      }\n    });\n  };\n\n  var styles = StyleSheet.create({\n    container: {\n      flex: 1,\n      flexDirection: \"row\",\n      borderWidth: 1,\n      borderColor: '#e7e6e7',\n      marginTop: 80,\n      marginLeft: 30,\n      marginRight: 30\n    },\n    contacts: {\n      flex: 2,\n      backgroundColor: 'white',\n      borderRightWidth: 1,\n      borderRightColor: '#e7e6e7'\n    },\n    messagesBox: {\n      flex: 4,\n      marginTop: 20\n    },\n    item: {\n      padding: 20,\n      borderBottomWidth: 1,\n      borderBottomColor: '#e7e6e7',\n      marginHorizontal: 8\n    },\n    msge: {\n      flexDirection: \"row\",\n      color: 'white'\n    },\n    message: {\n      alignSelf: \"flex-start\",\n      margin: 10,\n      borderRadius: 20,\n      borderWidth: 10,\n      borderColor: \"blue\",\n      color: 'white',\n      backgroundColor: 'blue'\n    },\n    sendMessage: {\n      width: '100%',\n      borderTopWidth: 1,\n      borderTopColor: '#e7e6e7'\n    }\n  });\n  var window = useWindowDimensions();\n  var msgStyle = {\n    maxHeight: window.height - 400,\n    overflow: 'scroll',\n    minHeight: 200\n  };\n\n  var _useState9 = useState(null),\n      _useState10 = _slicedToArray(_useState9, 2),\n      selectedId = _useState10[0],\n      setSelectedId = _useState10[1];\n\n  return React.createElement(Background, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 5\n    }\n  }, React.createElement(ScrollView, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 6\n    }\n  }, React.createElement(Navbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 7\n    }\n  }), React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }\n  }, React.createElement(View, {\n    style: styles.contacts,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 9\n    }\n  }, React.createElement(FlatList, {\n    data: matches,\n    renderItem: renderItem,\n    keyExtractor: function keyExtractor(item) {\n      return item.id;\n    },\n    extraData: selectedId,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 11\n    }\n  })), React.createElement(View, {\n    style: styles.messagesBox,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    style: msgStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 11\n    }\n  }, messages.map(function (_ref3) {\n    var id = _ref3.id,\n        text = _ref3.text,\n        photoURL = _ref3.photoURL,\n        uid = _ref3.uid;\n    return React.createElement(View, {\n      key: id,\n      style: styles.message,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 19\n      }\n    }, React.createElement(Image, {\n      src: photoURL,\n      alt: \"\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 23\n      }\n    }), React.createElement(Text, {\n      style: styles.msge,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 23\n      }\n    }, text));\n  })), React.createElement(View, {\n    style: styles.sendMessage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 11\n    }\n  }, React.createElement(TextInput, {\n    style: {\n      width: '78%',\n      fontSize: 15,\n      marginLeft: 15,\n      outline: 'none'\n    },\n    placeholder: \"Message...\",\n    value: message,\n    onChangeText: function onChangeText(e) {\n      return setMessage(e);\n    },\n    onSubmitEditing: function onSubmitEditing(event) {\n      return sendMessage(event);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 13\n    }\n  }))))));\n}","map":{"version":3,"sources":["/Users/nathanchackerian/Desktop/Impressive/screens/MessagesScreen.js"],"names":["React","useState","useEffect","useCallback","Background","MaterialCommunityIcons","Navbar","TextInput","$","firebase","storage","store","authenticate","convo","String","Math","floor","random","ChatScreen","props","message","setMessage","messages","setMessages","matches","setMatches","conversation","setConversation","collection","doc","orderBy","limit","onSnapshot","snapshot","docs","map","data","matchSnap","route","params","user","email","get","then","console","log","sendMessage","e","preventDefault","uid","currentUser","avatar","photoURL","length","set","createdAt","firestore","FieldValue","serverTimestamp","add","text","changeMessage","event","addClass","Item","name","onPress","backgroundColor","textColor","styles","item","title","renderItem","id","selectedId","color","setSelectedId","StyleSheet","create","container","flex","flexDirection","borderWidth","borderColor","marginTop","marginLeft","marginRight","contacts","borderRightWidth","borderRightColor","messagesBox","padding","borderBottomWidth","borderBottomColor","marginHorizontal","msge","alignSelf","margin","borderRadius","width","borderTopWidth","borderTopColor","window","useWindowDimensions","msgStyle","maxHeight","height","overflow","minHeight","fontSize","outline"],"mappings":"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","sourcesContent":["import React, {useState, useEffect, useCallback} from 'react'\nimport {View, ScrollView, Text, Button, StyleSheet, FlatList, useWindowDimensions, Platform} from 'react-native'\nimport Background from './Background'\nimport MaterialCommunityIcons from 'react-native-vector-icons/MaterialCommunityIcons'\nimport Navbar from './Navbar'\nimport TextInput from './TextInput'\nimport { TouchableOpacity, Image } from 'react-native';\nimport $ from 'jquery';\n\nimport firebase from 'firebase/app';\n\nimport { storage, store, authenticate } from \"../App.js\";\n\n// Random number\nconst convo = String(Math.floor(Math.random()*1000000000000000))\n\nexport default function ChatScreen(props) {\n  const [message, setMessage] = useState(\"\");\n  const [messages, setMessages] = useState([])\n  const [matches, setMatches] = useState([])\n  const [conversation, setConversation] = useState([])\n\n  useEffect(() => {\n      store.collection('messages').doc(convo).collection('convo').orderBy('createdAt').limit(50).onSnapshot(snapshot => {\n          setMessages(snapshot.docs.map(doc => doc.data()))\n      })\n\n      const matchSnap = store.collection('users').doc(props.route.params.user.email)\n\n      matchSnap.get().then((doc) => {\n          setMatches(doc.data().matches)\n          console.log(matches)\n      })\n\n  }, [])\n\n   async function sendMessage(e) {\n      e.preventDefault()\n      const uid = authenticate.currentUser.uid\n      const avatar = authenticate.currentUser.photoURL\n\n      if (message.length > 0){\n        await store.collection('messages').doc(convo).set({\n            createdAt: firebase.firestore.FieldValue.serverTimestamp()\n        })\n\n        await store.collection('messages').doc(convo).collection('convo').add({\n            text: message,\n            avatar,\n            uid,\n            createdAt: firebase.firestore.FieldValue.serverTimestamp()\n        })\n      }\n      setMessage('')\n  }\n\n  function changeMessage(event) {\n    console.log(\"Item\", event)\n    $(event).addClass('selected')\n    setConversation(\"name\")\n  }\n\n  const Item = ({ name, onPress, backgroundColor, textColor }) => (\n    <View style={styles.item} onClick={onPress} style={[styles.item, backgroundColor]}s>\n      <Text style={[styles.title, textColor]}>{name}</Text>\n    </View>\n  );\n\n  const renderItem = ({ item }) => {\n    const backgroundColor = item.id === selectedId ? \"red\" : \"white\";\n    const color = item.id === selectedId ? 'white' : 'black';\n\n    return (\n      <Item \n        item={item}\n        onPress={() => setSelectedId(item.id)}\n        backgroundColor={{ backgroundColor }}\n        textColor={{ color }}\n      />\n    );\n}\n\n  const styles = StyleSheet.create({\n    container: {\n      flex: 1,\n      flexDirection: \"row\",\n      borderWidth: 1,\n      borderColor: '#e7e6e7',\n      marginTop: 80,\n      marginLeft: 30,\n      marginRight: 30,\n    },\n    contacts: {\n      flex: 2,\n      backgroundColor: 'white',\n      borderRightWidth: 1,\n      borderRightColor: '#e7e6e7',\n    },\n    messagesBox: {\n      flex: 4,\n      marginTop: 20,\n    },\n    item: {\n      padding: 20,\n      borderBottomWidth: 1,\n      borderBottomColor: '#e7e6e7',\n      marginHorizontal: 8,\n    },\n    msge: {\n      flexDirection: \"row\",\n      color: 'white',\n    },\n    message: {\n      alignSelf: \"flex-start\",\n      margin: 10,\n      borderRadius: 20,\n      borderWidth: 10,\n      borderColor: \"blue\",\n      color: 'white',\n      backgroundColor: 'blue',\n    },\n    sendMessage: {\n      width: '100%',\n      borderTopWidth: 1,\n      borderTopColor: '#e7e6e7',\n    }\n  });\n\n  const window = useWindowDimensions();\n  const msgStyle = { maxHeight: window.height-400, overflow: 'scroll', minHeight: 200}\n  const [selectedId, setSelectedId] = useState(null);\n\n  return (\n    <Background>\n     <ScrollView>\n      <Navbar />\n      <View style={styles.container}>\n        <View style={styles.contacts}>\n          <FlatList\n            data={matches}\n            renderItem={renderItem}\n            keyExtractor={(item) => item.id}\n            extraData={selectedId}\n          /> \n        </View>\n        <View style={styles.messagesBox}>\n          <View style={msgStyle}>\n              {messages.map(({ id, text, photoURL, uid }) => (\n                  <View key={id} style={styles.message}>\n                      <Image src={photoURL} alt=\"\" />\n                      <Text style={styles.msge}>{text}</Text>\n                  </View>\n              ))}\n          </View>\n          <View style={styles.sendMessage}>\n            <TextInput \n               style={{ width: '78%', fontSize: 15, marginLeft: 15, outline: 'none' }}\n               placeholder='Message...'\n               value={message}\n               onChangeText={e => setMessage(e)} \n               onSubmitEditing={(event) => sendMessage(event)}\n            />\n        </View>\n       </View>\n      </View>\n      </ScrollView>\n    </Background>\n  )\n}\n\n"]},"metadata":{},"sourceType":"module"}