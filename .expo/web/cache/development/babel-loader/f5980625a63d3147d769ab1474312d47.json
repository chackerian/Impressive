{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/nathanchackerian/Desktop/Impressive/screens/ImageScreen.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect } from 'react';\nimport * as WebBrowser from \"expo-web-browser\";\nimport * as ImagePicker from 'expo-image-picker';\nimport Image from \"react-native-web/dist/exports/Image\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Button from \"./Button\";\nimport firebase from 'firebase/app';\nimport 'firebase/storage';\nimport 'firebase/firestore';\nexport default function ImageScreen(props) {\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      image = _useState2[0],\n      setImage = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      url = _useState4[0],\n      setImageURL = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      color = _useState6[0],\n      setColorValue = _useState6[1];\n\n  var uploadImage = function uploadImage(uri) {\n    var response, blob, filename, refs;\n    return _regeneratorRuntime.async(function uploadImage$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(fetch(uri));\n\n          case 2:\n            response = _context.sent;\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(response.blob());\n\n          case 5:\n            blob = _context.sent;\n            filename = \"images/\" + \"IMG\" + Math.round(Math.random() * 100);\n            refs = firebase.storage().ref().child(filename);\n            refs.put(blob).then(function (snapshot) {\n              firebase.storage().ref(filename).getDownloadURL().then(function (url) {\n                setImageURL(url);\n                var user = props.route.params.user.email;\n                firebase.firestore().collection('users').doc(user).update({\n                  picture: url\n                });\n              });\n            });\n\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var openImagePicker = function openImagePicker() {\n    var permissionResult, pickerResult;\n    return _regeneratorRuntime.async(function openImagePicker$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(ImagePicker.requestMediaLibraryPermissionsAsync());\n\n          case 2:\n            permissionResult = _context2.sent;\n            _context2.next = 5;\n            return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync());\n\n          case 5:\n            pickerResult = _context2.sent;\n            setImage(pickerResult.uri);\n\n            if (!pickerResult.cancelled) {\n              uploadImage(pickerResult.uri);\n            }\n\n          case 8:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var setColor = function setColor(color) {\n    setColorValue(color);\n  };\n\n  return React.createElement(View, {\n    style: styles.container,\n    onClick: openImagePicker,\n    onDragOver: setColor('blue'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }\n  }, React.createElement(Button, {\n    mode: \"outlined\",\n    color: \"black\",\n    onPress: openImagePicker,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }\n  }, \"Upload Image\"), image && React.createElement(Image, {\n    source: {\n      uri: image\n    },\n    style: {\n      width: 200,\n      height: 200\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 19\n    }\n  }));\n}\nvar styles = StyleSheet.create({\n  container: {\n    alignItems: 'center',\n    marginTop: 30,\n    minHeight: 150,\n    borderRadius: 2,\n    borderStyle: 'dashed',\n    borderColor: 'black'\n  }\n});","map":{"version":3,"sources":["/Users/nathanchackerian/Desktop/Impressive/screens/ImageScreen.js"],"names":["React","useState","useEffect","WebBrowser","ImagePicker","Button","firebase","ImageScreen","props","image","setImage","url","setImageURL","color","setColorValue","uploadImage","uri","fetch","response","blob","filename","Math","round","random","refs","storage","ref","child","put","then","snapshot","getDownloadURL","user","route","params","email","firestore","collection","doc","update","picture","openImagePicker","requestMediaLibraryPermissionsAsync","permissionResult","launchImageLibraryAsync","pickerResult","cancelled","setColor","styles","container","width","height","StyleSheet","create","alignItems","marginTop","minHeight","borderRadius","borderStyle","borderColor"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport * as WebBrowser from \"expo-web-browser\";\nimport * as ImagePicker from 'expo-image-picker';\nimport { Image, StyleSheet, Text, View } from \"react-native\";\nimport Button from './Button'\nimport firebase from 'firebase/app';\nimport 'firebase/storage';\nimport 'firebase/firestore';\n\nexport default function ImageScreen(props) {\n\n  const [image, setImage] = useState(null);\n  const [url, setImageURL] = useState(\"\");\n  const [color, setColorValue] = useState(\"\");\n\n  const uploadImage = async (uri) => {\n    const response = await fetch(uri);\n    const blob = await response.blob();\n\n    var filename = \"images/\" + \"IMG\" + Math.round(Math.random()*100)\n\n    var refs = firebase.storage().ref().child(filename);\n    refs.put(blob).then((snapshot) => {\n      firebase.storage().ref(filename).getDownloadURL()\n        .then((url) => {\n          setImageURL(url);\n          var user = props.route.params.user.email\n          firebase.firestore().collection('users').doc(user).update({\n            picture: url\n          })\n      })\n\n    })\n\n  }\n\n  let openImagePicker = async () => {\n    let permissionResult = await ImagePicker.requestMediaLibraryPermissionsAsync();\n    let pickerResult = await ImagePicker.launchImageLibraryAsync();\n\n    setImage(pickerResult.uri);\n\n    if (!pickerResult.cancelled) {\n      uploadImage(pickerResult.uri)\n    }\n  }\n\n  const setColor = (color) => {\n    setColorValue(color)\n  }\n\n  // const dropped = (event) => {\n  //   event.preventDefault();\n  //   let dataTransferItemsList = []\n  //   if (event.dataTransfer) {\n  //     console.log('pic', event.dataTransfer);\n  //     const dt = event.dataTransfer\n  //     if (dt.files && dt.files.length) {\n  //       dataTransferItemsList = dt.files\n  //     } else if (dt.items && dt.items.length) {\n  //       dataTransferItemsList = dt.items\n  //     }\n  //   } \n\n  //   if (event.target && event.target.files) {\n  //     dataTransferItemsList = event.target.files\n  //     console.log('files', event.target.files);\n  //   }\n  // }\n\n        //   onDragEnter={(event) => dropped(event)}\n        // onDrop={(event) => dropped(event)}\n        // onDragLeave={setColor('black')}\n\n  return (\n      <View style={styles.container}\n        onClick={openImagePicker}\n        onDragOver={setColor('blue')}\n      >\n      <Button\n        mode=\"outlined\"\n        color=\"black\"\n        onPress={openImagePicker}>Upload Image</Button>\n        {image && <Image source={{ uri: image }} style={{ width: 200, height: 200 }} />}\n      </View>\n    )\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    alignItems: 'center',\n    marginTop: 30,\n    minHeight: 150,\n    borderRadius: 2,\n    borderStyle: 'dashed',\n    borderColor: 'black',\n  }\n})\n\n"]},"metadata":{},"sourceType":"module"}