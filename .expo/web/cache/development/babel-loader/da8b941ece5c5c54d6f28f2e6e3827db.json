{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/rando/Desktop/Impressive/screens/MessagesScreen.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect, useCallback } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Background from \"./Background\";\nimport MaterialCommunityIcons from \"@expo/vector-icons/MaterialCommunityIcons\";\nimport Navbar from \"./Navbar\";\nimport TextInput from \"./TextInput\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport \"./Chat.js\";\nimport firebase from 'firebase/app';\nimport { storage, store, authenticate } from \"../App.js\";\nvar convo = String(Math.floor(Math.random() * 1000000000000000));\nexport default function ChatScreen(_ref) {\n  var _this = this;\n\n  var navigation = _ref.navigation;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      message = _useState2[0],\n      setMessage = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      messages = _useState4[0],\n      setMessages = _useState4[1];\n\n  useEffect(function () {\n    store.collection('messages').doc(convo).collection('convo').orderBy('createdAt').limit(50).onSnapshot(function (snapshot) {\n      setMessages(snapshot.docs.map(function (doc) {\n        return doc.data();\n      }));\n    });\n  }, []);\n\n  function sendMessage(e) {\n    var uid, avatar;\n    return _regeneratorRuntime.async(function sendMessage$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            e.preventDefault();\n            uid = authenticate.currentUser.uid;\n            avatar = authenticate.currentUser.photoURL;\n\n            if (!(message.length > 0)) {\n              _context.next = 8;\n              break;\n            }\n\n            _context.next = 6;\n            return _regeneratorRuntime.awrap(store.collection('messages').doc(convo).set({\n              createdAt: firebase.firestore.FieldValue.serverTimestamp()\n            }));\n\n          case 6:\n            _context.next = 8;\n            return _regeneratorRuntime.awrap(store.collection('messages').doc(convo).collection('convo').add({\n              text: message,\n              avatar: avatar,\n              uid: uid,\n              createdAt: firebase.firestore.FieldValue.serverTimestamp()\n            }));\n\n          case 8:\n            setMessage('');\n\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  var StyleSheets = function () {\n    function StyleSheets() {\n      _classCallCheck(this, StyleSheets);\n    }\n\n    _createClass(StyleSheets, null, [{\n      key: \"create\",\n      value: function create(obj) {\n        var result = {};\n\n        for (var key in obj) {\n          result[key] = obj[key];\n        }\n\n        return result;\n      }\n    }]);\n\n    return StyleSheets;\n  }();\n\n  var styles = StyleSheets.create({\n    msg: {\n      display: 'flex',\n      paddingTop: 0,\n      paddingBottom: 10,\n      paddingLeft: 0,\n      paddingRight: 10,\n      margin: 5,\n      marginTop: 40,\n      borderRadius: 4,\n      alignItems: 'center',\n      color: 'white',\n      backgroundColor: 'blue',\n      flexDirection: 'column',\n      borderLeft: '1 solid #e7e6e7',\n      width: '77%'\n    }\n  });\n  return React.createElement(Background, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 5\n    }\n  }, React.createElement(ScrollView, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 6\n    }\n  }, React.createElement(Navbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }\n  }), React.createElement(View, {\n    className: \"container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }\n  }, React.createElement(View, {\n    className: \"contacts\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 9\n    }\n  }), React.createElement(View, {\n    className: \"msgs\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  }, messages.map(function (_ref2) {\n    var id = _ref2.id,\n        text = _ref2.text,\n        photoURL = _ref2.photoURL,\n        uid = _ref2.uid;\n    return React.createElement(View, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 19\n      }\n    }, React.createElement(View, {\n      key: id,\n      style: styles.msg,\n      className: \"msg \" + (uid === authenticate.currentUser.uid ? 'sent' : 'received'),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 23\n      }\n    }, React.createElement(Image, {\n      src: photoURL,\n      alt: \"\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 27\n      }\n    }), React.createElement(Text, {\n      className: \"message\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 27\n      }\n    }, text)));\n  })), React.createElement(TextInput, {\n    style: {\n      width: '78%',\n      fontSize: 15,\n      fontWeight: '600',\n      marginLeft: 5,\n      marginBottom: -3\n    },\n    theme: {\n      colors: {\n        primary: 'blue',\n        underlineColor: 'transparent'\n      }\n    },\n    placeholder: \"Message...\",\n    value: message,\n    onChangeText: function onChangeText(e) {\n      return setMessage(e);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 9\n    }\n  }))));\n}","map":{"version":3,"sources":["/Users/rando/Desktop/Impressive/screens/MessagesScreen.js"],"names":["React","useState","useEffect","useCallback","Background","MaterialCommunityIcons","Navbar","TextInput","firebase","storage","store","authenticate","convo","String","Math","floor","random","ChatScreen","navigation","message","setMessage","messages","setMessages","collection","doc","orderBy","limit","onSnapshot","snapshot","docs","map","data","sendMessage","e","preventDefault","uid","currentUser","avatar","photoURL","length","set","createdAt","firestore","FieldValue","serverTimestamp","add","text","StyleSheets","obj","result","key","styles","create","msg","display","paddingTop","paddingBottom","paddingLeft","paddingRight","margin","marginTop","borderRadius","alignItems","color","backgroundColor","flexDirection","borderLeft","width","id","fontSize","fontWeight","marginLeft","marginBottom","colors","primary","underlineColor"],"mappings":"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","sourcesContent":["import React, {useState, useEffect, useCallback} from 'react'\nimport {View, ScrollView, Text, Button, StyleSheet} from 'react-native'\nimport Background from './Background'\nimport MaterialCommunityIcons from 'react-native-vector-icons/MaterialCommunityIcons'\nimport Navbar from './Navbar'\nimport TextInput from './TextInput'\nimport { TouchableOpacity, Image } from 'react-native';\n// import SendIcon from '@mui/icons-material/Send';\nimport './Chat.js';\n\nimport firebase from 'firebase/app';\n\nimport { storage, store, authenticate } from \"../App.js\";\nconst convo = String(Math.floor(Math.random()*1000000000000000))\n\nexport default function ChatScreen({ navigation }) {\n  const [message, setMessage] = useState([]);\n  const [messages, setMessages] = useState([])\n  useEffect(() => {\n      store.collection('messages').doc(convo).collection('convo').orderBy('createdAt').limit(50).onSnapshot(snapshot => {\n          setMessages(snapshot.docs.map(doc => doc.data()))\n      })\n  }, [])\n\n   async function sendMessage(e) {\n        e.preventDefault()\n        const uid = authenticate.currentUser.uid\n        const avatar = authenticate.currentUser.photoURL\n\n        if (message.length > 0){\n          await store.collection('messages').doc(convo).set({\n              createdAt: firebase.firestore.FieldValue.serverTimestamp()\n          })\n\n          await store.collection('messages').doc(convo).collection('convo').add({\n              text: message,\n              avatar,\n              uid,\n              createdAt: firebase.firestore.FieldValue.serverTimestamp()\n          })\n        }\n        setMessage('')\n    }\n\n  class StyleSheets {\n    static create(obj) {\n      var result = {};\n      for (var key in obj) {\n        result[key] = obj[key]\n      }\n      return result;\n    }\n  }  \n\n  const styles = StyleSheets.create({\n    msg: {\n      display: 'flex',\n      paddingTop: 0,\n      paddingBottom: 10,\n      paddingLeft: 0,\n      paddingRight: 10,\n      margin: 5,\n      marginTop: 40,\n      borderRadius: 4,\n      alignItems: 'center',\n      color: 'white',\n      backgroundColor: 'blue',\n      flexDirection: 'column',\n      borderLeft: '1 solid #e7e6e7',\n      width: '77%',\n\n    },\n  });\n\n  return (\n    <Background>\n     <ScrollView>\n      <Navbar />\n      <View className=\"container\">\n        <View className=\"contacts\"></View>\n        <View className=\"msgs\">\n              {messages.map(({ id, text, photoURL, uid }) => (\n                  <View>\n                      <View key={id} style={styles.msg} className={`msg ${uid === authenticate.currentUser.uid ? 'sent' : 'received'}`}>\n                          <Image src={photoURL} alt=\"\" />\n                          <Text className=\"message\">{text}</Text>\n                      </View>\n                  </View>\n              ))}\n        </View>\n        <TextInput \n       style={{ width: '78%', fontSize: 15, fontWeight: '600', marginLeft: 5, marginBottom: -3 }}\n       theme={{ colors: { primary: 'blue',underlineColor:'transparent',}}}\n       placeholder='Message...'\n       value={message}\n       onChangeText={e => setMessage(e)} \n       // onKeyPress={(event) => sendMessage(event)}\n       />\n      </View>\n      </ScrollView>\n    </Background>\n  )\n}\n\n"]},"metadata":{},"sourceType":"module"}